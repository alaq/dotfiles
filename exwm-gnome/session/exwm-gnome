#!/bin/sh

# Register with gnome-session so that it does not kill the whole session thinking it is dead.
test -n "$DESKTOP_AUTOSTART_ID" && {
    dbus-send --print-reply --session --dest=org.gnome.SessionManager "/org/gnome/SessionManager" org.gnome.SessionManager.RegisterClient "string:exwm-gnome" "string:$DESKTOP_AUTOSTART_ID"
}

# exec /usr/lib/gnome-settings-daemon/gsd-xsettings
# exec gnome-power-manager
# exec /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
exec gnome-flashback &
emacs

# logout process.
test -n "$DESKTOP_AUTOSTART_ID" && {
	dbus-send --print-reply --session --dest=org.gnome.SessionManager "/org/gnome/SessionManager" org.gnome.SessionManager.Logout "uint32:1"
}


# { exec gnome-flashback } &
# { emacs } &
# wait -n
# pkill -P $$
